<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>‚ú®üêç‚ú®</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section>
                    <h2>format | lint | pre-commit</h2>
                    <h3>‚ú® üêç ‚ú®</h3>
                </section>
                <section>
                    <p><img style="margin: -10px 15px;" height="50px" src="images/linkedin.png"/><a style="text-decoration: none;" href="https://www.linkedin.com/in/arthurio/" target="_blank">linkedin.com/in/arthurio</a></p>
                    <p><img style="margin: -10px 15px;" height="50px" src="images/notivize.png"/><a style="text-decoration: none;" href="https://notivize.com" target="_blank">notivize.com</a></p>
                    <p><img style="margin: -10px 15px;" height="50px" src="images/github.png"/><a style="text-decoration: none;" href="https://github.com/arthurio/pre-commit" target="_blank">github.com/arthurio/pre-commit</a></p>
                </section>
                <section>
                    <section data-markdown>
                        # Tools

                        ## üß∞

                        ---

                        ## Formatters  üßº ‚ú®

                        [isort](https://pycqa.github.io/isort/): isort your imports, so you don't have to.

                        [black](https://black.readthedocs.io/en/stable/): The Uncompromising Code Formatter.

                        [flynt](https://github.com/ikamensh/flynt): String formatting converter.

                        ---

                        ## Linters  üëÆ‚Äç‚ôÄÔ∏èüëÆ‚Äç‚ôÇÔ∏è

                        [bandit](https://bandit.readthedocs.io/en/latest/): Find common security issues.

                        [flake8](https://flake8.pycqa.org/en/latest/index.html#): Your Tool For Style Guide Enforcement.

                        [flake8-docstrings](https://gitlab.com/pycqa/flake8-docstrings): Flake8 plugin to include checks provided by pep257.

                        [mypy](https://mypy.readthedocs.io/en/stable/index.html): Static type checker.

                        ---

                        ## Automation  üë®‚Äçüîßü§ñ

                        [pre-commit](https://pre-commit.com/): A framework for managing and maintaining multi-language pre-commit hooks.
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Configuration

                        ![ross shush](images/ross_shushing.jpg)

                        Keep it to a minimum


                        ---

                        ## black


                        ```
                        # pyproject.toml

                        [tool.black]
                        line-length = 120
                        ```

                        ---

                        ## isort

                        ```
                        # pyproject.toml

                        [tool.isort]
                        profile = "black"
                        line_length = 120
                        skip_gitignore = true
                        ```

                        ---

                        ## flynt

                        Nothing to see here üëÄ ...

                        ---

                        ## bandit

                        ```
                        # .bandit

                        [bandit]
                        targets: src,tests
                        skips: B101
                        ```

                        - [B101](https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing): assert used

                        Note:
                        - ‚ö†Ô∏è  Don't confuse the "ini" file **AND/OR** the "yaml" config file. ‚ö†Ô∏è
                        - assert is removed with compiling to optimized byte code.
                        - Bandit likes to complain about random, use the secrets module instead if you can or silent individual lines with `# nosec: B311`
                        ---

                        ## flake8/flake8-docstrings

                        ```
                        # .flake8

                        [flake8]
                        max_line_length = 120
                        ignore = D1
                        docstring-convention = google
                        ```

                        - [W503](https://www.flake8rules.com/rules/W503.html): Line break occurred before a binary operator
                        - [D1](http://www.pydocstyle.org/en/stable/error_codes.html): Missing docstring

                        Note:
                        - I don't care about missing docstrings as I try to keep them to a minimum. Instead I prefer to rely on explicit variable and function names, as well as type hints.
                        - W503 is not compatible with black and goes against PEP 8.

                        ---

                        ## Mypy

                        ```ini
                        # mypy.ini

                        [mypy]
                        mypy_path = ./src:./tests
                        ```

                        Note:
                        Mypy doesn't support pyproject.toml configuration, only mypy.ini and setup.cfg.
                    </section>
                    <section>
                        <h2>pre-commit</h2>

                        <span style="font-size: 20px;">
                        <pre class="code-wrapper"><code class="yaml hljs" style="max-height: none; height: 585px;">
                        repos:
                          - repo: local
                            hooks:
                              - id: isort
                                name: isort
                                entry: isort
                                types: [python]
                                language: python
                              - id: flynt
                                name: flynt
                                entry: flynt
                                args: [--fail-on-change]
                                types: [python]
                                language: python
                              - id: black
                                name: black
                                entry: black
                                language: python
                                types: [python]
                                exclude: node_modules
                              - id: flake8
                                name: flake8
                                entry: flake8
                                language: python
                                types: [python]
                                exclude: .serverless,node_modules
                              - id: bandit
                                name: bandit
                                entry: bandit
                                language: python
                                types: [python]
                                args:  [--ini, .bandit, --recursive]
                              - id: mypy
                                name: mypy
                                entry: mypy
                                types: [python]
                                language: python
                          - repo: https://github.com/pre-commit/pre-commit-hooks
                            rev: v4.0.1
                            hooks:
                              - id: end-of-file-fixer
                                exclude: .*(min.js|min.css|html|svg|css.map|js.map)
                              - id: trailing-whitespace
                                exclude: .*(md)
                        </code></pre>
                        </span>
                        <aside class="notes">
                            Notice that everything is setup as "local" because I keep track of the packages (black, flake8, etc.) in my dev-requirements.in.
                        </aside>
                    </section>
                    <section data-markdown>
                        ## Dev requirements


                        ```
                        # dev-requirements.in

                        bandit==1.7.0
                        black==21.4b2
                        flake8-docstrings==1.6.0
                        flake8==3.9.1
                        flynt==0.64
                        isort==5.8.0
                        mypy==0.812
                        pre-commit==2.12.1
                        ```

                        Note:
                        We use pip-tools to compile our requirements.txt files with pinned libraries for dependencies.
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Usage

                        ---

                        ## Setup your IDE/Editor

                        ![pycharm](images/pycharm.png)  ![vim](images/vim.png)  ![vscode](images/vscode.png)
                        ![sublime](images/sublime.png)  ![emacs](images/emacs.png)  ![atom](images/atom.png)

                        ---

                        ## Install pre-commit hook

                        ```bash
                        pre-commit install
                        git add .
                        git commit -m "Some bad code"
                        ```

                        Note:
                        - You can configure pre-commit to use any sort of hooks, pre/post push, pre/post message, etc.
                        - pre-commit runs only for the staged files, not the entire project. And only relevant linters/formatters are applied.
                    </section>
                    <section>
                        <img src="images/git_commit_fail.png" alt="git commit failure" height="650px"/>
                        <aside class="notes">
                            <ul>
                                <li>Linters only show errors but generally don't fix the issue.</li>
                                <li>Formatters automatically fix the code so you'll unstaged changes.</li>
                            </ul>
                        </aside>
                    </section>
                    <section data-markdown>
                        ![git commit](images/git_commit.png)

                        ---

                        ![git commit skip](images/git_commit_skip.png)

                        ---

                        ## Continuous Integration

                        ```bash
                        pre-commit run --all-files
                        ```

                        Note:
                        Devs can skip hooks with `git commit --no-verify`.
                    </section>
                </section>
                <section>
                    <h1>Q&A</h1>
                    <p><img style="margin: -10px 15px;" height="50px" src="images/linkedin.png"/><a style="text-decoration: none;" href="https://www.linkedin.com/in/arthurio/" target="_blank">linkedin.com/in/arthurio</a></p>
                    <p><img style="margin: -10px 15px;" height="50px" src="images/notivize.png"/><a style="text-decoration: none;" href="https://notivize.com" target="_blank">notivize.com</a></p>
                    <p><img style="margin: -10px 15px;" height="50px" src="images/github.png"/><a style="text-decoration: none;" href="https://github.com/arthurio/pre-commit" target="_blank">github.com/arthurio/pre-commit</a></p>
                </section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/zoom/zoom.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/search/search.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealSearch, RevealMarkdown, RevealHighlight, RevealNotes ],

                slideNumber: "c/t",
				controls: true,
				progress: true,
                showNotes: false,  // Set to true for printing pdf
			});
		</script>
	</body>
</html>
